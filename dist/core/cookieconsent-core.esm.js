/*!
* CookieConsent 3.0.1
* https://github.com/orestbida/cookieconsent
* Author Orest Bida
* Released under the MIT License
*/
import e from'@iabtechlabtcf/stub';import{CmpApi as t}from'@iabtechlabtcf/cmpapi';import{GVL as o,TCModel as n,TCString as s}from'@iabtechlabtcf/core';const r='opt-in',a='opt-out',c='data-category';class i{constructor(){this.t={mode:r,revision:0,autoClearCookies:!0,manageScriptTags:!0,hideFromBots:!0,cookie:{name:'cc_cookie',expiresAfterDays:182,domain:'',path:'/',sameSite:'Lax'}},this.o={i:{},l:'',u:{},_:{},p:{},m:{},C:null,v:!1,S:!1,h:[],D:[],I:[],N:[],T:[],j:[],k:[],F:!1,A:null,L:null,O:null,P:'',R:!0,V:!1,M:!0,G:[],J:!1,U:'',$:!1,B:[],H:[],q:[],K:[],W:!1,X:{},Y:{},Z:{},ee:{},te:{},oe:[]},this.ne={},this.se={re:'cc:onFirstConsent',ae:'cc:onConsent',ce:'cc:onChange'}}}const l=new i,d=()=>{l.o.S||l.o.v||(e(),l.o.v=!0)};window.onload=d;const f=(e,t)=>e.indexOf(t),u=(e,t)=>-1!==f(e,t),_=e=>Array.isArray(e),p=e=>'string'==typeof e,g=e=>!!e&&'object'==typeof e&&!_(e),m=e=>'function'==typeof e,C=e=>Object.keys(e),v=e=>Array.from(new Set(e)),S=e=>{const t=document.createElement(e);return'button'===e&&(t.type=e),t},y=(e,t,o)=>e.setAttribute(t,o),h=(e,t,o)=>{e.removeAttribute(o?'data-'+t:t)},w=(e,t,o)=>e.getAttribute(o?'data-'+t:t),b=e=>{if('object'!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());let t=Array.isArray(e)?[]:{};for(let o in e){let n=e[o];t[o]=b(n)}return t},D=()=>{const e={},{B:t,X:o,Y:n}=l.o;for(const s of t)e[s]=k(n[s],C(o[s]));return e},I=(e,t)=>{const{B:o,H:n,q:s,ie:r,Z:a,K:c,X:i}=l.o;let d=[];if(e){_(e)?d.push(...e):p(e)&&(d='all'===e?o:[e]);for(const e of o)a[e]=u(d,e)?C(i[e]):[]}else d=[...n,...c];d=d.filter((e=>!u(o,e)||!u(t,e))),d.push(...s),F(d)},N=e=>{const t=l.o,{Z:o,q:n,Y:s,X:r,B:a}=t,c=e?[e]:a;t.te=b(s);for(const e of c){const a=r[e],c=C(a),i=o[e]&&o[e].length>0,l=u(n,e);if(0!==c.length){if(s[e]=[],l)s[e].push(...c);else if(i){const t=o[e];s[e].push(...t)}else s[e]=t.Z[e];s[e]=v(s[e])}}},T=e=>{if(!l.t.isTcfCompliant)return;const{vendors:t}=l.o.C;let o=[];'all'===e?o=t.map((e=>e.id)):_(e)&&(o=e),l.o.T=o},j=()=>{const e=l.t.cookie.expiresAfterDays;return m(e)?e(l.o.U):e},k=(e,t)=>{const o=e||[],n=t||[];return o.filter((e=>!u(n,e))).concat(n.filter((e=>!u(o,e))))},F=e=>{l.o.H=v(e),l.o.U=(()=>{let e='custom';const{H:t,B:o,q:n}=l.o,s=t.length;return s===o.length?e='all':s===n.length&&(e='necessary'),e})()},A=(e,t,o)=>{const{ce:n,ae:s,re:r,le:a,de:c,fe:i}=l.ne,d=l.se,f=l.t.isTcfCompliant,u={cookie:l.o.p};e===d.re?m(r)&&r(b(u)):e===d.ae?m(s)&&s(b(u)):(u.changedCategories=l.o.G,u.changedServices=l.o.ee,f&&(u.changedPurposeIds=l.o.D,u.changedSpecialFeatureIds=l.o.N,u.changedVendorIds=l.o.j),m(n)&&n(b(u))),((e,t)=>{dispatchEvent(new CustomEvent(e,{detail:t}))})(e,b(u))},x=(e,t)=>{try{return e()}catch(e){return!t&&console.warn('CookieConsent:',e),!1}},E=e=>{const{Y:t,ee:o,B:n,X:s,oe:r,p:a,G:i}=l.o;for(const e of n){const n=o[e]||t[e]||[];for(const o of n){const n=s[e][o];if(!n)continue;const{onAccept:r,onReject:a}=n;!n.ue&&u(t[e],o)?(n.ue=!0,m(r)&&r()):n.ue&&!u(t[e],o)&&(n.ue=!1,m(a)&&a())}}if(!l.t.manageScriptTags)return;const d=r,f=e||a.categories||[],_=(e,n)=>{if(n>=e.length)return;const s=r[n];if(s._e)return _(e,n+1);const a=s.pe,l=s.ge,d=s.me,p=u(f,l),g=!!d&&u(t[l],d);if(!d&&!s.Ce&&p||!d&&s.Ce&&!p&&u(i,l)||d&&!s.Ce&&g||d&&s.Ce&&!g&&u(o[l]||[],d)){s._e=!0;const t=w(a,'type',!0);h(a,'type',!!t),h(a,c);let o=w(a,'src',!0);o&&h(a,'src',!0);const r=S('script');r.textContent=a.innerHTML;for(const{nodeName:e}of a.attributes)y(r,e,a[e]||w(a,e));t&&(r.type=t),o?r.src=o:o=a.src;const i=!!o&&(!t||['text/javascript','module'].includes(t));if(i&&(r.onload=r.onerror=()=>{_(e,++n)}),a.replaceWith(r),i)return}_(e,++n)};_(d,0)},L=e=>x((()=>localStorage.removeItem(e)));let O,P;const R=()=>{const{t:e}=l;if(!e.isTcfCompliant)return;if(!ce()||!O||!P)return void P.update('',!0);const t=new n(O);t.isServiceSpecific=!0;const{p:o,C:r}=l.o,a=e.tcfComplianceConfig;t.vendorsDisclosed.set(r.vendorIds),t.vendorConsents.set(o.vendorIds),t.vendorLegitimateInterests.set(o.vendorIds),t.purposeConsents.set(o.purposeIds),t.specialFeatureOptins.set(o.specialFeatureIds),t.useNonStandardTexts=!1,t.cmpId=a.cmpId,t.cmpVersion=a.cmpVersion;const c=s.encode(t);P.update(c,!1)},V=(e,t)=>{if(t instanceof RegExp)return e.filter((e=>t.test(e)));{const o=f(e,t);return o>-1?[e[o]]:[]}},M=()=>{const e=l.t.isTcfCompliant,t=l.o;t.G=l.t.mode===a&&t.R?k(t.K,t.H):k(t.H,t.p.categories);let o=t.G.length>0,n=!1;for(const e of t.B)t.ee[e]=k(t.Y[e],t.te[e]),t.ee[e].length>0&&(n=!0);const s=t.p.purposeIds??[],c=t.p.specialFeatureIds??[],i=t.p.vendorIds??[];t.D=k(s,t.h),t.N=k(c,t.I),t.j=k(i,t.T);const d=t.D.length>0,f=t.N.length>0,_=t.j.length>0;t.L||(t.L=new Date),t.P||(t.P=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))),t.p={categories:b(t.H),revision:l.t.revision,data:t.A,consentTimestamp:t.L.toISOString(),consentId:t.P,services:b(t.Y),...e&&{purposeIds:b(t.h),specialFeatureIds:b(t.I),vendorIds:b(t.T)}};let p=!1;const g=o||n||d||f||_;(t.R||g)&&(t.R&&(t.R=!1,p=!0),t.O=t.O?new Date:t.L,t.p.lastConsentTimestamp=t.O.toISOString(),G(),l.t.autoClearCookies&&(p||g)&&(e=>{const t=l.o,o=B(),n=(e=>{const t=l.o;return(e?t.B:t.G).filter((e=>{const o=t.$[e];return!!o&&!o.readOnly&&!!o.autoClear}))})(e);for(const e in t.ee)for(const n of t.ee[e]){const s=t.X[e][n].cookies;if(!u(t.Y[e],n)&&s)for(const e of s){const t=V(o,e.name);J(t,e.path,e.domain)}}for(const s of n){const n=t.$[s].autoClear,r=n&&n.cookies||[],a=u(t.G,s),c=!u(t.H,s),i=a&&c;if(e?c:i){n.reloadPage&&i&&(t.J=!0);for(const e of r){const t=V(o,e.name);J(t,e.path,e.domain)}}}})(p),E(),R()),p&&(A(l.se.re),A(l.se.ae),l.t.mode===r)||(g&&A(l.se.ce),t.J&&(t.J=!1,location.reload()))},G=e=>{const{hostname:t,protocol:o}=location,{name:n,path:s,domain:r,sameSite:a,useLocalStorage:c}=l.t.cookie,i=e?(()=>{const e=l.o.O,t=e?new Date-e:0;return 864e5*j()-t})():864e5*j(),d=new Date;d.setTime(d.getTime()+i),l.o.p.expirationTime=d.getTime();const f=JSON.stringify(l.o.p);let _=n+'='+encodeURIComponent(f)+(0!==i?'; expires='+d.toUTCString():'')+'; Path='+s+'; SameSite='+a;u(t,'.')&&(_+='; Domain='+r),'https:'===o&&(_+='; Secure'),c?((e,t)=>{x((()=>localStorage.setItem(e,t)))})(n,f):document.cookie=_,l.o.p},J=(e,t,o)=>{if(0===e.length)return;const n=o||l.t.cookie.domain,s=t||l.t.cookie.path,r='www.'===n.slice(0,4),a=r&&n.substring(4),c=(e,t)=>{document.cookie=e+'=; path='+s+(t?'; domain=.'+t:'')+'; expires=Thu, 01 Jan 1970 00:00:01 GMT;'};for(const t of e)c(t),c(t,n),r&&c(t,a)},U=e=>{const t=e||l.t.cookie.name,o=l.t.cookie.useLocalStorage;return((e,t)=>{let o;return o=x((()=>JSON.parse(t?e:decodeURIComponent(e))),!0)||{},o})(o?(n=t,x((()=>localStorage.getItem(n)))||''):$(t,!0),o);var n},$=(e,t)=>{const o=document.cookie.match('(^|;)\\s*'+e+'\\s*=\\s*([^;]+)');return o?t?o.pop():e:''},B=e=>{const t=document.cookie.split(/;\s*/),o=[];for(const n of t){let t=n.split('=')[0];e?x((()=>{e.test(t)&&o.push(t)})):o.push(t)}return o},H=(e,t=[],o='all',n='all',s='all')=>{I(e,t),N(),((e,t)=>{if(!l.t.isTcfCompliant)return;const{vendors:o}=l.o.C;let n=[],s=[];if(_(e)&&(n=e),_(t)&&(s=t),'all'===e||'all'===t)for(const r of o)'all'===e&&n.push(...r.purposes),'all'===t&&s.push(...r.specialFeatures);n=v(n),s=v(s),l.o.h=n,l.o.I=s})(o,n),T(s),M()},q=(e,t=[])=>{I(e,t),N(),M()},z=e=>{T(e),M()},K=e=>{const t=l.o.R?[]:l.o.H;return u(t,e)},Q=e=>{const t=l.o.R?[]:l.o.h;return u(t,e)},W=e=>{const t=l.o.R?[]:l.o.I;return u(t,e)},X=e=>{const t=l.o.R?[]:l.o.T;return u(t,e)},Y=(e,t)=>{const{B:o,X:n}=l.o;if(!(e&&t&&p(t)&&u(o,t)&&0!==C(n[t]).length))return!1;q()},Z=(e,t)=>{const o=l.o.R?[]:l.o.Y[t]||[];return u(o,e)},ee=e=>''!==$(e,!0),te=(e,t,o)=>{let n=[];const s=e=>{if(p(e)){let t=$(e);''!==t&&n.push(t)}else n.push(...B(e))};if(_(e))for(let t of e)s(t);else s(e);J(n,t,o)},oe=()=>{const{U:e,Y:t}=l.o,{accepted:o,rejected:n}=(()=>{const{R:e,H:t,B:o}=l.o;return{accepted:t,rejected:e?[]:o.filter((e=>!u(t,e)))}})();return b({acceptType:e,acceptedCategories:o,rejectedCategories:n,acceptedServices:t,rejectedServices:D()})},ne=(e,t)=>{let o=document.querySelector('script[src="'+e+'"]');return new Promise((n=>{if(o)return n(!0);if(o=S('script'),g(t))for(const e in t)y(o,e,t[e]);var s,r;o.onload=()=>n(!0),o.onerror=()=>{o.remove(),n(!1)},o.src=e,s=document.head,r=o,s.appendChild(r)}))},se=e=>{let t,o=e.value,n=e.mode,s=!1;const r=l.o;if('update'===n){r.A=t=re('data');const e=typeof t==typeof o;if(e&&'object'==typeof t){!t&&(t={});for(let e in o)t[e]!==o[e]&&(t[e]=o[e],s=!0)}else!e&&t||t===o||(t=o,s=!0)}else t=o,s=!0;return s&&(r.A=t,r.p.data=t,G(!0)),s},re=(e,t)=>{const o=U(t);return e?o[e]:o},ae=e=>{const t=l.t,o=l.o.i;return e?t[e]||o[e]:{...t,...o,cookie:{...t.cookie}}},ce=()=>!l.o.R,ie=async e=>{const{o:n,t:s,se:r}=l,i=window;if(!i._ccRun){if(i._ccRun=!0,(e=>{const{ve:t,t:o,o:n}=l,s=o,r=n,{cookie:i}=s,d=l.ne,f=e.cookie,_=e.categories,p=C(_)||[],m=navigator,v=document;t.Se=v,i.domain=location.hostname,r.i=e,r.$=_,r.B=p,d.re=e.onFirstConsent,d.ae=e.onConsent,d.ce=e.onChange;const{mode:S,autoClearCookies:y,revision:h,manageScriptTags:b,hideFromBots:D}=e;S===a&&(s.mode=S),'boolean'==typeof y&&(s.autoClearCookies=y),'boolean'==typeof b&&(s.manageScriptTags=b),'number'==typeof h&&h>=0&&(s.revision=h,r.V=!0),!1===D&&(s.hideFromBots=!1),!0===s.hideFromBots&&m&&(r.W=m.userAgent&&/bot|crawl|spider|slurp|teoma/i.test(m.userAgent)||m.webdriver),g(f)&&(s.cookie={...i,...f}),s.autoClearCookies,r.V,s.manageScriptTags,s.isTcfCompliant,s.tcfComplianceConfig,(e=>{const{$:t,X:o,Y:n,Z:s,q:r}=l.o;for(let a of e){const e=t[a],c=e.services||{},i=g(c)&&C(c)||[];o[a]={},n[a]=[],s[a]=[],e.readOnly&&(r.push(a),n[a]=i),l.ve.ye[a]={};for(let e of i){const t=c[e];t.ue=!1,o[a][e]=t}}})(p),(()=>{if(!l.t.manageScriptTags)return;const e=l.o,t=(o=document,n='script['+c+']',o.querySelectorAll(n));var o,n;for(const o of t){let t=w(o,c),n=o.dataset.service||'',s=!1;if(t&&'!'===t.charAt(0)&&(t=t.slice(1),s=!0),'!'===n.charAt(0)&&(n=n.slice(1),s=!0),u(e.B,t)&&(e.oe.push({pe:o,_e:!1,Ce:s,ge:t,me:n}),n)){const o=e.X[t];o[n]||(o[n]={ue:!1})}}})()})(e),n.W)return;if((()=>{const e=l.o,t=l.t,o=U(),{categories:n,services:s,purposeIds:r,specialFeatureIds:c,vendorIds:i,consentId:d,consentTimestamp:f,lastConsentTimestamp:u,data:g,revision:m}=o,C=_(n),v=_(r),S=_(c),y=_(i);e.p=o,e.P=d;const h=!!d&&p(d);e.L=f,e.L&&(e.L=new Date(f)),e.O=u,e.O&&(e.O=new Date(u)),e.A=void 0!==g?g:null,e.V&&h&&m!==t.revision&&(e.M=!1),t.isTcfCompliant?e.R=!(h&&e.M&&e.L&&e.O&&C&&v&&S&&y):e.R=!(h&&e.M&&e.L&&e.O&&C),t.cookie.useLocalStorage&&!e.R&&(e.R=(new Date).getTime()>(o.expirationTime||0),e.R&&L(t.cookie.name)),e.R,(()=>{const e=l.o;for(const t of e.B){const o=e.$[t];if(o.readOnly||o.enabled){e.K.push(t);const o=e.X[t]||{};for(let n in o)e.Z[t].push(n),e.i.mode===a&&e.Y[t].push(n)}}})(),e.R?t.mode===a&&(e.H=[...e.K]):(e.Z={...e.Y},e.Y={...e.Y,...s},t.isTcfCompliant&&(e.h=r,e.I=c,e.T=i),F([...e.q,...n]))})(),await(async()=>{const{t:e,o:n}=l;if(!e.isTcfCompliant)return;n.v||d();const{cmpId:s,cmpVersion:r,disclosedVendorIds:a,gvlBaseUrl:c,gvlDefaultFileName:i='vendor-list.json',gvlLanguageFileName:f='vendor-list-[LANG].json'}=e.tcfComplianceConfig??{},u=n.l;try{const e=`${c}/${'en'===u?i:f.replace('[LANG]',u)}`,t=await fetch(e);if(!t.ok)throw new Error(`${t.status}: ${t.statusText}`);const s=await t.json();n.m=s,n.C=(e=>{const t=l.o.m,o=e?.length?e.filter((e=>e in t.vendors)):Object.keys(t.vendors),n=t.purposes,s=t.specialPurposes,r=t.features,a=t.specialFeatures,c=t.stacks,i=Object.values(t.stacks),d=o.map((e=>t.vendors[e])),f=d.map((e=>{const o=e.purposes.map((e=>t.purposes[e])),n=e.legIntPurposes.map((e=>t.purposes[e])),s=e.flexiblePurposes.map((e=>t.purposes[e])),r=e.specialPurposes.map((e=>t.specialPurposes[e])),a=e.features.map((e=>t.features[e])),c=e.specialFeatures.map((e=>t.specialFeatures[e])),i=e.dataDeclaration.map((e=>t.dataCategories[e]));return{...e,purposes:o,legIntPurposes:n,flexiblePurposes:s,specialPurposes:r,features:a,specialFeatures:c,dataDeclaration:i}}));return{originalPurposes:n,originalSpecialPurposes:s,originalFeatures:r,originalSpecialFeatures:a,originalStacks:c,stacks:i,vendors:d,vendorCount:o.length,vendorIds:o,extendedVendors:f}})(a),O=new o(s)}catch(e){console.error('An error occurred while loading the GVL:',e)}P=new t(s,r,!0),n.S=!0,R()})(),ce())return E(),A(r.ae);s.mode===a&&E(n.K)}},le=e=>{const{name:t,path:o,domain:n,useLocalStorage:s}=l.t.cookie;e&&(s?L(t):te(t,o,n));for(const{he:e,we:t,be:o}of l.o.k)e.removeEventListener(t,o);const r=new i;for(const e in l)l[e]=r[e];window._ccRun=!1};export{q as acceptCategory,H as acceptMultiple,Y as acceptService,K as acceptedCategory,Q as acceptedPurpose,Z as acceptedService,W as acceptedSpecialFeature,z as allowVendors,X as allowedVendor,te as eraseCookies,ae as getConfig,re as getCookie,oe as getUserPreferences,ne as loadScript,le as reset,ie as run,se as setCookieData,ce as validConsent,ee as validCookie};
